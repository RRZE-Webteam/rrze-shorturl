jQuery(document).ready((function(t){var e=document.getElementById("shortened_url"),a=e?e.value:"https://www.fau.de";new QRious({element:document.getElementById("qr"),value:a,size:200,background:"transparent"});function o(t){const e=document.getElementById("shorturl-tooltip");e.textContent=t,e.style.display="inline-block",setTimeout((()=>{e.style.display="none"}),2e3)}t("#customer-domains-form, #services-form").on("submit",(function(){if(t(this).find('input[type="checkbox"]:checked').length>0){if(!confirm("WARNING! Are you sure you want to delete the selected entries? All Short URLs related to them will be deleted, too. This action cannot be undone."))return!1}})),t("#show-advanced-settings").addClass("shorturl-link-disabled"),t("#url").on("input",(function(){""!==t(this).val().trim()?t("#show-advanced-settings").attr("href","#").removeClass("shorturl-link-disabled"):t("#show-advanced-settings").removeAttr("href").addClass("shorturl-link-disabled")})),t("#btn-show-advanced-settings").on("click",(function(e){e.preventDefault(),t("#shorturl-advanced-settings").slideToggle(),t(this).hasClass("active")?(t("span.arrow-up").removeClass("arrow-up").addClass("arrow-down"),t(this).attr("aria-expanded","false")):(t("span.arrow-down").removeClass("arrow-down").addClass("arrow-up"),t(this).attr("aria-expanded","true")),t(this).toggleClass("active")})),t(document).on("mouseover",".shorturl-category-row",(function(){t(this).find(".shorturl-edit-category, .shorturl-delete-category").removeClass("hidden")})),t(document).on("mouseleave",".shorturl-category-row",(function(){t(this).find(".shorturl-edit-category, .shorturl-delete-category").addClass("hidden")})),t(document).on("click",".shorturl-edit-category",(function(e){e.preventDefault();var a=t(this).siblings(".shorturl-category-label").text().trim(),o=t(this).data("id");t(this).parent().html("<div class='shorturl-edit-container'><input type='text' class='shorturl-category-input' data-id='"+o+"' value='"+a+"'><button class='shorturl-update-category' data-id='"+o+"'>Update</button></div>")})),t(document).on("click",".shorturl-update-category",(function(){var e=t(this).data("id"),a=t(this).parent().find(".shorturl-category-input").val();t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"update_category_label_action",category_id:e,updated_label:a,_ajax_nonce:rrze_shorturl_ajax_object.update_category_label_nonce},success:function(o){t("p").html(o.data),t(".shorturl-category-input[data-id='"+e+"']").parent().html("<span class='category-label'>"+a+"</span>")},error:function(t,e,a){}})})),t("#new-shorturl-category").slideToggle(),t("#add-new-shorturl-category").on("click",(function(e){e.preventDefault(),t("#new-shorturl-category").slideToggle()})),t(document).on("click","#add-shorturl-category-btn",(function(e){e.preventDefault();var a=t("input[name=new_shorturl_category]").val();a?t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",data:{action:"add_shorturl_category",categoryName:a,parentCategory:t("select[name=parent_category]").val(),_ajax_nonce:rrze_shorturl_ajax_object.add_shorturl_category_nonce},success:function(e){if(e.success){t("#shorturl-category-metabox").html(e.data.category_list_html);var a=e.data.category_id;t('input[name="shorturl_categories[]"][value="'+a+'"]').prop("checked",!0)}else alert("Failed to add category. Please try again.")}}):alert("Please enter a category name.")})),t(document).on("click",".edit-link",(function(e){e.preventDefault();var a=t(this).data("link-id"),o=window.location.href.split("?")[0]+"?link_id="+a+"#edit-link-form";window.location.href=o})),t(document).on("click",".delete-link",(function(e){e.preventDefault();var a=t(this).data("link-id");confirm("Are you sure you want to delete this link?")&&t.ajax({url:rrze_shorturl_ajax_object.ajax_url,method:"POST",data:{action:"delete_link",link_id:a,_ajax_nonce:rrze_shorturl_ajax_object.delete_shorturl_link_nonce},success:function(t){location.reload()},error:function(t,e,a){}})})),t(document).on("change",".allow-uri-checkbox, .allow-get-checkbox, .allow-utm-checkbox",(function(){var e,a=t(this).data("id");e=t(this).hasClass("allow-uri-checkbox")?"allow_uri":t(this).hasClass("allow-utm-checkbox")?"allow_utm":"allow_get";var o=t(this).prop("checked")?"true":"false";t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",data:{action:"update_idm",id:a,field:e,value:o,_ajax_nonce:rrze_shorturl_ajax_object.update_shorturl_idm_nonce},success:function(t){location.reload()},error:function(t,e,a){}})})),t(document).on("click","#copyButton",(function(e){return e.preventDefault(),function(t){if(t)if(navigator.clipboard)navigator.clipboard.writeText(t).then((()=>{o("URL copied!")})).catch((t=>{}));else{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",document.body.appendChild(e),e.select();try{document.execCommand("copy"),o("URL copied!")}catch(t){}finally{document.body.removeChild(e)}}}(t(this).data("shortened-url")),e.stopPropagation(),!1})),t(document).on("click","#downloadButton",(function(t){t.preventDefault();var e=document.getElementById("qr"),a=document.createElement("a");return a.href=e.toDataURL("image/png"),a.download="qr-code.png",document.body.appendChild(a),a.click(),document.body.removeChild(a),t.stopPropagation(),!1})),t("table.shorturl-categories tbody").on("mouseover","td.category-label",(function(){t(this).find(".edit-link").length||t(this).append('<a href="#" class="edit-link">Edit</a>')})),t("table.shorturl-categories tbody").on("mouseout","td.category-label",(function(e){var a=t(this).find(".edit-link");a.is(":hover")||a.hasClass("editing")||a.remove()})),t("table.shorturl-categories tbody").on("click",".edit-link",(function(e){e.preventDefault(),e.stopPropagation(),t(this).hide();var a=t(this).closest("td").find("span"),o=a.text().trim();a.html('<input type="text" class="category-input">').find(".category-input").val(o),t(".category-input").focus().select(),t(this).addClass("editing")})),t("table.shorturl-categories tbody").on("blur",".category-input",(function(){var e=t(this).val().trim(),a=t(this).closest("td").data("id"),o=t(this).parent().find(".edit-link");t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",data:{action:"update_shorturl_category_label",category_id:a,updated_label:e,_ajax_nonce:rrze_shorturl_ajax_object.update_category_label_nonce},success:function(a){var r=t("<span>").text(e);t(this).parent().empty().append(r),o.show()}.bind(this)})})),t(document).on("click",".delete-category",(function(e){e.preventDefault();var a=t(this).data("category-id");confirm("Are you sure you want to delete this category?")&&t.ajax({url:rrze_shorturl_ajax_object.ajax_url,method:"POST",data:{action:"delete_category",category_id:a,_ajax_nonce:rrze_shorturl_ajax_object.delete_shorturl_category_nonce},success:function(t){var e=window.location.href;e=e.split("?")[0],window.location.href=e},error:function(t,e,a){}})})),t(document).on("click",".edit-category-button",(function(){var e=t(this).data("category-id");t(".edit-category-form[data-category-id="+e+"]").toggle(),t(".shorturl-wp-list-table").hide()}))}));