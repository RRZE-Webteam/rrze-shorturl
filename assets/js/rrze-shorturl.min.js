jQuery(document).ready((function(t){function e(t){const e=document.getElementById("tooltip");e.textContent=t,e.style.display="inline-block",setTimeout((()=>{e.style.display="none"}),2e3)}t("#customer-domains-form, #services-form").on("submit",(function(){if(t(this).find('input[type="checkbox"]:checked').length>0){if(!confirm("WARNING! Are you sure you want to delete the selected entries? All Short URLs related to them will be deleted, too. This action cannot be undone."))return!1}})),t("#show-advanced-settings").on("click",(function(e){e.preventDefault(),t("#div-advanced-settings").slideToggle()})),t('#div-advanced-settings input[type="text"], #div-advanced-settings input[type="date"], #div-advanced-settings select').on("change",(function(){t("#generate").prop("value","Update")})),t(document).on("mouseover",".shorturl-category-row",(function(){t(this).find(".shorturl-edit-category, .shorturl-delete-category").removeClass("hidden")})),t(document).on("mouseleave",".shorturl-category-row",(function(){t(this).find(".shorturl-edit-category, .shorturl-delete-category").addClass("hidden")})),t(document).on("click",".shorturl-edit-category",(function(e){e.preventDefault();var a=t(this).siblings(".shorturl-category-label").text().trim(),o=t(this).data("id");t(this).parent().html("<div class='shorturl-edit-container'><input type='text' class='shorturl-category-input' data-id='"+o+"' value='"+a+"'><button class='shorturl-update-category' data-id='"+o+"'>Update</button></div>")})),t(document).on("click",".shorturl-update-category",(function(){var e=t(this).data("id"),a=t(this).parent().find(".shorturl-category-input").val();t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"update_category_label_action",category_id:e,updated_label:a,_ajax_nonce:rrze_shorturl_ajax_object.update_category_label_nonce},success:function(o){t("p").html(o.data),t(".shorturl-category-input[data-id='"+e+"']").parent().html("<span class='category-label'>"+a+"</span>")},error:function(t,e,a){}})})),t("#tag-tokenfield").select2({tags:!0,tokenSeparators:[","],placeholder:"Add tags"}),t("#tag-tokenfield").on("select2:selecting",(function(e){var a=e.params.args.data.text;e.params.args.data.id===e.params.args.data.text&&t.ajax({url:rrze_shorturl_ajax_object.ajax_url,method:"POST",data:{action:"add_shorturl_tag",new_tag_name:a,dataType:"json",_ajax_nonce:rrze_shorturl_ajax_object.add_shorturl_tag_nonce},success:function(e){if(e.success){var o=e.data.id;t('#tag-tokenfield option[value="'+a+'"]').remove(),t("#tag-tokenfield").append('<option value="'+o+'" selected>'+a+"</option>"),t("#tag-tokenfield").trigger("change")}},error:function(t,e,a){}})})),t("#new-shorturl-category").slideToggle(),t("#add-new-shorturl-category").on("click",(function(e){e.preventDefault(),t("#new-shorturl-category").slideToggle()})),t("#add-shorturl-category-btn").on("click",(function(e){e.preventDefault();var a=t("input[name=new_shorturl_category]").val();a?t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",data:{action:"add_shorturl_category",categoryName:a,parentCategory:t("select[name=parent_category]").val(),_ajax_nonce:rrze_shorturl_ajax_object.add_shorturl_category_nonce},success:function(e){if(e.success){t("#shorturl-category-metabox").html(e.data.category_list_html);var a=e.data.category_id;t('input[name="shorturl_categories[]"][value="'+a+'"]').prop("checked",!0)}else alert("Failed to add category. Please try again.")}}):alert("Please enter a category name.")})),t(document).on("click",".edit-link",(function(e){e.preventDefault();var a=t(this).data("link-id"),o=window.location.href.split("?")[0]+"?link_id="+a+"#edit-link-form";window.location.href=o})),t(document).on("click",".delete-link",(function(e){e.preventDefault();var a=t(this).data("link-id");confirm("Are you sure you want to delete this link?")&&t.ajax({url:rrze_shorturl_ajax_object.ajax_url,method:"POST",data:{action:"delete_link",link_id:a,_ajax_nonce:rrze_shorturl_ajax_object.delete_shorturl_link_nonce},success:function(t){location.reload()},error:function(t,e,a){}})})),t(".allow-uri-checkbox, .allow-get-checkbox").change((function(){var e=t(this).data("id"),a=t(this).hasClass("allow-uri-checkbox")?"allow_uri":"allow_get",o=t(this).prop("checked")?"true":"false";t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",data:{action:"update_idm",id:e,field:a,value:o,_ajax_nonce:rrze_shorturl_ajax_object.update_shorturl_idm_nonce},success:function(t){location.reload()},error:function(t,e,a){}})})),t(document).on("click","#copyButton",(function(a){return a.preventDefault(),function(t){if(t)if(navigator.clipboard)navigator.clipboard.writeText(t).then((()=>{e("URL copied!")})).catch((t=>{}));else{const a=document.createElement("textarea");a.value=t,a.style.position="fixed",document.body.appendChild(a),a.select();try{document.execCommand("copy"),e("URL copied!")}catch(t){}finally{document.body.removeChild(a)}}}(t(this).data("shortened-url")),a.stopPropagation(),!1})),t("table.shorturl-categories tbody").on("mouseover","td.category-label",(function(){t(this).find(".edit-link").length||t(this).append('<a href="#" class="edit-link">Edit</a>')})),t("table.shorturl-categories tbody").on("mouseout","td.category-label",(function(e){var a=t(this).find(".edit-link");a.is(":hover")||a.hasClass("editing")||a.remove()})),t("table.shorturl-categories tbody").on("click",".edit-link",(function(e){e.preventDefault(),e.stopPropagation(),t(this).hide();var a=t(this).closest("td").find("span"),o=a.text().trim();a.html('<input type="text" class="category-input">').find(".category-input").val(o),t(".category-input").focus().select(),t(this).addClass("editing")})),t("table.shorturl-categories tbody").on("blur",".category-input",(function(){var e=t(this).val().trim(),a=t(this).closest("td").data("id"),o=t(this).parent().find(".edit-link");t.ajax({url:rrze_shorturl_ajax_object.ajax_url,type:"POST",data:{action:"update_shorturl_category_label",category_id:a,updated_label:e,_ajax_nonce:rrze_shorturl_ajax_object.update_category_label_nonce},success:function(a){var r=t("<span>").text(e);t(this).parent().empty().append(r),o.show()}.bind(this)})})),t(document).on("click",".delete-category",(function(e){e.preventDefault();var a=t(this).data("category-id");confirm("Are you sure you want to delete this category?")&&t.ajax({url:rrze_shorturl_ajax_object.ajax_url,method:"POST",data:{action:"delete_category",category_id:a,_ajax_nonce:rrze_shorturl_ajax_object.delete_shorturl_category_nonce},success:function(t){var e=window.location.href;e=e.split("?")[0],window.location.href=e},error:function(t,e,a){}})})),t(".edit-category-button").click((function(){var e=t(this).data("category-id");t(".edit-category-form[data-category-id="+e+"]").toggle(),t(".wp-list-table").hide()})),t(".edit-tag-button").click((function(){var e=t(this).data("tag-id");t(".edit-tag-form[data-tag-id="+e+"]").toggle(),t(".wp-list-table").hide()})),t(document).on("click",".delete-tag",(function(e){e.preventDefault();var a=t(this).data("tag-id");confirm("Are you sure you want to delete this tag?")&&t.ajax({url:rrze_shorturl_ajax_object.ajax_url,method:"POST",data:{action:"delete_tag",tag_id:a,_ajax_nonce:rrze_shorturl_ajax_object.delete_shorturl_tag_nonce},success:function(t){var e=window.location.href;e=e.split("?")[0],window.location.href=e},error:function(t,e,a){}})}))}));